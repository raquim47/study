<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>meme maker</title>
  <style>
    body {
      display: flex;
      justify-content: center;
      align-items: center;
    }

    canvas {
      width: 800px;
      height: 800px;
      border: 1px solid black;
    }

    .color-option {
      width: 50px;
      height: 50px;
      cursor: pointer;
    }
  </style>
</head>

<body>
  <canvas id="canvas"></canvas>
  <input id="line-width" type="range" min="1" max="10" value="5" step="0.5">
  <input id="color" type="color">
  <div>
    <div class="color-option" style="background-color: #1abc9c;" data-color="#1abc9c"></div>
    <div class="color-option" style="background-color: #3498db;" data-color="#3498db"></div>
    <div class="color-option" style="background-color: #34495e;" data-color="#34495e"></div>
    <div class="color-option" style="background-color: #27ae60;" data-color="#27ae60"></div>
    <div class="color-option" style="background-color: #8e44ad;" data-color="#8e44ad"></div>
    <div class="color-option" style="background-color: #f1c40f;" data-color="#f1c40f"></div>
    <div class="color-option" style="background-color: #e74c3c;" data-color="#e74c3c"></div>
    <div class="color-option" style="background-color: #95a5a6;" data-color="#95a5a6"></div>
    <div class="color-option" style="background-color: #d35400;" data-color="#d35400"></div>
    <div class="color-option" style="background-color: #bdc3c7;" data-color="#bdc3c7"></div>
    <div class="color-option" style="background-color: #2ecc71;" data-color="#2ecc71"></div>
    <div class="color-option" style="background-color: #e67e22;" data-color="#e67e22"></div>
  </div>
  <button id="mode-btn">Fill</button>
  <button id="reset-btn">reset</button>
  <button id="eraser-btn">eraser</button>
  <script>
    // 유사배열 htmlCollection
    const colorOptions = Array.from(document.querySelectorAll('.color-option'));
    const canvas = document.querySelector("#canvas");
    const lineWidth = document.querySelector("#line-width");
    const color = document.querySelector("#color");
    const modeBtn = document.querySelector("#mode-btn");
    const resetBtn = document.querySelector("#reset-btn");
    const eraserBtn = document.querySelector("#eraser-btn");
    const ctx = canvas.getContext("2d");
    canvas.width = 800;
    canvas.height = 800;
    ctx.lineWidth = lineWidth.value;

    let isPainting = false;
    let isFilling = false;

    function onMove(e) {
      if (isPainting) {
        ctx.lineTo(e.offsetX, e.offsetY);
        ctx.stroke();
        return;
      }
      ctx.beginPath();
      ctx.moveTo(e.offsetX, e.offsetY);
    }

    function startPainting() {
      isPainting = true;
    }

    function cancelPainting() {
      isPainting = false;
    }

    function onLineWidthChange(e) {
      ctx.lineWidth = e.target.value;
    }

    function onColorChange(e) {
      ctx.strokeStyle = ctx.fillStyle = e.target.value;
    }

    function onColorClick(e) {
      const colorValue = e.target.dataset.color;
      ctx.strokeStyle = ctx.fillStyle = color.value = colorValue;
    }

    function onModeClick() {
      if (isFilling) {
        isFilling = false;
        modeBtn.innerText = "Fill";
      } else {
        isFilling = true;
        modeBtn.innerText = "Draw";
      }
    }

    function onCanvasClick() {
      if (isFilling) {
        ctx.fillRect(0, 0, 800, 800)
      } else {}
    }

    function onResetClick(){
      ctx.clearRect(0, 0, ctx.canvas.width, ctx.canvas.height);
    }
    function onEraserClick(){
      ctx.strokeStyle = 'white';
      isFilling = false;
      modeBtn.innerText = 'Fill'
    }
    canvas.addEventListener('click', onCanvasClick);
    canvas.addEventListener('mousemove', onMove);
    canvas.addEventListener('mousedown', startPainting);
    canvas.addEventListener('mouseup', cancelPainting);
    canvas.addEventListener('mouseleave', cancelPainting);
    lineWidth.addEventListener('change', onLineWidthChange);
    color.addEventListener('change', onColorChange);

    colorOptions.forEach(color => color.addEventListener('click', onColorClick));

    modeBtn.addEventListener('click', onModeClick);
    resetBtn.addEventListener('click', onResetClick);
    eraserBtn.addEventListener('click', onEraserClick);
  </script>
</body>

</html>